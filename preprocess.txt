import pandas as pd
import numpy as np
from sklearn.impute import SimpleImputer, KNNImputer
df = pd.read_excel( "path_to_your_excel_path.xlsx")
df = df.rename(columns={
    "Heating Rate（℃/min）": "Heating_Rate",
    "Heating Temperature（℃）": "Heating_Temp",
    "Heating Time（h）": "Heating_Time",
    "C：N（Atomic Ratio）": "C_N_Ratio",
    "SSA（m²/g）": "SSA",
    "Stacking Distance（nm）": "Stacking_Distance",
    "XRD Peak（°）": "XRD_Peak",
    "Bandgap（ev）": "Bandgap",
    "cut-off": "Cut_off",
    "Sacrifice Agent": "Sacrifice_Agent",
    "SA（%）": "SA_percent",
    "Co-catalysts": "Co_catalysts",
    "Cc（%）": "Cc_percent",
    "HER Rate（μmol/g/h）": "HER_Rate"
})
target_col = "HER_Rate"
df = df.dropna(subset=[target_col])
all_features = [col for col in df.columns if col != target_col]
numeric_features = [col for col in all_features if pd.api.types.is_numeric_dtype(df[col])]
categorical_features = [col for col in all_features if col not in numeric_features]
key_features = ["C_N_Ratio", "CB", "VB"]
numeric_features_other = [col for col in numeric_features if col not in key_features]
print(numeric_features_other)
key_features
imputer = SimpleImputer(strategy='median')
df[numeric_features_other] = imputer.fit_transform(df[numeric_features_other])
for col in categorical_features:
    df[col] = df[col].fillna("missing")
knn_imputer = KNNImputer(n_neighbors=5)
df[numeric_features] = knn_imputer.fit_transform(df[numeric_features])
df = pd.get_dummies(df, columns=categorical_features, drop_first=False)
df["HER_Rate_log"] = np.log10(df[target_col] + 1e-9)  
df = df.drop(columns=["HER_Rate"])  