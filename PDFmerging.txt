import os
import PyPDF2
folder_a = "path_to_your_folder_a"
folder_b = "path_to_your_folder_b"
output_folder = "path_to_your_output_folder"
if not os.path.exists(output_folder):
    os.makedirs(output_folder)
pdf_files_a = [f for f in os.listdir(folder_a) if f.endswith('.pdf')]
pdf_files_b = [f for f in os.listdir(folder_b) if f.endswith('.pdf')]
if len(pdf_files_a) != len(pdf_files_b):
    print("两个文件夹中的PDF文件数量不同，无法一一对应合并。")
    exit()
for i in range(len(pdf_files_a)):
    file_a = os.path.join(folder_a, pdf_files_a[i])
    file_b = os.path.join(folder_b, pdf_files_b[i])
    output_file = os.path.join(output_folder, f"merged_{i+1}.pdf")
    pdf_a = PyPDF2.PdfReader(open(file_a, "rb"))
    pdf_b = PyPDF2.PdfReader(open(file_b, "rb"))
    pdf_writer = PyPDF2.PdfWriter()
    for page in pdf_a.pages:
        pdf_writer.add_page(page)
    for page in pdf_b.pages:
        pdf_writer.add_page(page)
    with open(output_file, "wb") as out_file:
        pdf_writer.write(out_file)
    print(f"合并完成：{output_file}")
pdf_files_c = [f for f in os.listdir(output_folder) if f.endswith('.pdf')]
pdf_count_c = len(pdf_files_c)
print(f"合并完成后C文件夹中的PDF数量：{pdf_count_c}")